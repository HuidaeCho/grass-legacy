# $Id$
# updated 2. Nov. 1999 
# updated 31 octobre 1999 to build libimage.a - Pierre de Mouveaux.
#                                       (p_de_mouveaux@hotmail.com)
#
# tcltkNVIZ2.2 - 8/1999 Jaro Hofierka
#
# 10/99: move libimage to src/libes and
#          updated libimage path to src/libes/libimage
#        updated ogsf path to src/libes/ogsf/
#
# olgnviz v1.0 - 5/1/96
#
# Toplevel makefile for building everything - used by configure script to 
# build Gmakefile

NV_VER=sed
NVWISH_VER=sed
INSTALL_DIR=$(GISBASE)/etc/nviz2.2

SCRIPTDIR=$(NV_VER)/scripts

all: nvwish nviz install

nvwish:
	$(GMAKE) $(LIBDIR)/libimage
	$(GMAKE) $(LIBDIR)/ogsf
	cd src ; $(GMAKE) 

nviz:
#	'rm' -rf $(NV_VER)
#	mkdir $(NV_VER)
	'rm' -rf $(GISBASE)/etc/$(NV_VER)
	mkdir $(GISBASE)/etc/$(NV_VER)

# do we need this? MN 3/2000: - obviously not
#	cat scripts/script_file_tools.in | sed s/ProcessName/$(NV_VER)/g >> \
#	    $(SCRIPTDIR)/script_file_tools
#	cat scripts/script_tools.in | sed s/ProcessName/$(NV_VER)/g >> \
#	    $(SCRIPTDIR)/script_tools


# Install the scripts in the appropriate directory
install:
	'rm' -rf $(INSTALL_DIR)
	mkdir $(INSTALL_DIR)
	mkdir $(INSTALL_DIR)/scripts
	mkdir $(INSTALL_DIR)/bitmaps
	(cd scripts; cp script_get_line script_play script_tools script_file_tools $(INSTALL_DIR)/scripts)
	'cp' scripts/*.tcl $(INSTALL_DIR)/scripts
	'cp' scripts/*Index $(INSTALL_DIR)/scripts
	(cd bitmaps; tar -cf - *  | (cd $(INSTALL_DIR)/bitmaps; tar  -xf - 2>/dev/null ); true)
	cp scripts/$(NV_VER)_script $(INSTALL_DIR)/scripts
	cp scripts/$(NV_VER) $(GISBASE)/bin
	chmod ugo+x $(INSTALL_DIR)/scripts/$(NV_VER)_script \
		$(INSTALL_DIR)/scripts/script_file_tools \
		$(INSTALL_DIR)/scripts/script_get_line \
		$(INSTALL_DIR)/scripts/script_play \
		$(INSTALL_DIR)/scripts/script_tools \
		$(GISBASE)/bin/$(NV_VER)
#	'cp' nviz.man.1 $(GISBASE)/man/1/$(NV_VER)
	gmakelinks5
