Known bugs in GRASS 5
$Id: BUGS,v 1.16 2000-09-09 11:55:18 markus Exp $

Maintained by
   Markus Neteler
   neteler@geog.uni-hannover.de
Please send a note if detecting an unknown bug.
Bugfixes are very welcome!

----------------------------------------------------------------
[In sync with GRASS 5 beta 9/CVS]
History at end of file.

----------- drivers ---------------------------------------------
CELL-Driver: colors are not correct
 Comment from Carl Anderson <candrsn@mindspring.com>
  Tracking of the "bug" will have to start in
  src/display/d.rast/cmd/display.c
  Since GRASS4 did the colors right, using both GRASS4 and GRASS5
  drivers, I suspect one of the Libraries and not the XDRIVER.
  look at D_set_colors ().


----------- modules ---------------------------------------------
d.his: 
 - color wrong if input value=0
 - added NULL randomly when using "out" for saving

d.legend:
 - option "-n" does not work. no data is colored with color of
   highest category

d.mon: hangs with "-L" option
   (would be nice to fix to improve "d.monsize" script
  Andreas Lange wrote:
  The d.mon -L bug only occurs on Linux, on IRIX
  everything is ok. I read the code and experimented with it, but i
  couldn't find the problem. This is something for the signal
  specialists/system programmers from BSD and SYSV.

d.param.scale
 - lower axis description not readable
 - sometimes "floating point exeption", especially in par=geary

d.profile: the min/max printed at profile are wrong
           sometimes the entire profile wrong
           obviously problem with fp/int maps

d.rast.num: some numbers are displayed in wrong (unreadable) color

d.rgb: Is there a difference between d.rgb and i.composite?

d.site.label: needs to be updated to new sites API

d.sites.label needs modified for the new Sites API

d.sites.qual: not all the sites are used/displayed
  d.sites.qual doesn't work properly: not all the sites 
  are used/displayed if the number of fields of the input site file is 
  not constant. Compare with d.sites.

i.ortho.photo
 - if second control point is set by mouse, it is not indicated
   immediately in orange color (right window)
 - GIS WARNING: Can't write embedded null values for map open for random
   access: i.ortho.photo/photo.rectify/write.c needs to be updated.
 - photo2target/mark.c needs to be updated to support FP elevations
    function: static int get_z_from_cell ()

i.tape.tm.fast: (Todd Shoemaker, jtshoe@datasync.com)
- Attempting to change the default Title causes a segfault.

p.map.new:
 - p.map.new now works but only with the grass4.2 raster files
   With the GRASS5.0 floating point raster files it gives the following
   error.
   WARNING: [desi] in mapset [PERMANENT] - format field in header file
   invalid
   WARNING: unable to open raster map [desi] in mapset [PERMANENT]
   desi in PERMANENT : can't open raster file
   I think it is to do with the new format of GRASS5.0 raster files.
 -> 5/2000: still a problem??

r3.showdspf.openGL:  (src.contrib/GMSL/g3d/src3d/raster/r3.showdspf.openGL)
 - the dependency to OpenGL and Mesa should be checked automatically
   and maybe the sgi-widget should be compiled in statically.
   it will not work with standard Mesa RPMS, because the sgi-widgets
   are missing. Generally you need to have the Mesa source and compile 
   the libGLw yourself (which is described in the README.mesa31 in the
   source for grass.) [Bernhard]

r.binfer
  bug in table.c causing segfault

r.contour: (reported by D D Gray <ddgray@armadce.demon.co.uk>)
 Though it is not a stability problem, I've found that if this module is
 run on an elev raster with an active old-style mask, i.e applied with
 r.mask, the contour lines which terminate on the mask boundary (but only
 these) are duplicated, as if reflected off the mask boundary. The
 resulting line is then closed giving a closed loop that is folded in on
 itself with a node at one end or in the middle of the line, and no node
 at the other. This is most clearly seen when viewed with v.digit. I have
 not seen a prior report of this problem though I have looked. My
 apologies if this has already been documented. Though I can't look into
 this myself at the moment, I have prepared a quick fix in the form of an
 awk post-processor which ´cleans' this problem, splitting the loop and
 removing the duplicate segment (it also removes ´degenerate' lines ie.  
 lines of one point which r.contour creates occasionally.) I have added  
 this as an extension, though I stress it is just a temporary fix.
 (script: v.asc.degen)

r.in.hdf/r.out.hdf (src.garden/grass.hdf)
 - needs updating to HDF4.x lib (already there)

r.in.png:
  seg. faults on Pentium CPU (compare r.binfer)

r.in.ppm
  seg. fault on Pentium CPU (compare r.binfer)
  Memory bug fixed by Alex Shevlakov

r.in.tiff/r.out.tiff
 - segm. fault (same thing with r.binfer)

r.mapcalc
 - Values -129 in GRASS raster files are treated as Null
  (already fixed for FreeBSD/Linux. Check for other platforms, 
   corrections go here:
   src/libes/gis/null_val.c)

 - r.mapcalc/polish: (when compiling)
make[2]: Entering directory
/home/neteler/src5/grass5.0beta/src/raster/r.mapcalc/polish'
rm -f lex.yy.c y.tab.c
rm -f OBJ.i586-linux-elf/main.o
gcc -g -O2   -I/home/neteler/src5/grass5.0beta/src/include  -c main.c
mv main.o OBJ.i586-linux-elf/main.o
flex pol.l
yacc pol.y
yacc: 14 shift/reduce conflicts, 17 reduce/reduce conflicts.

r.null:
 does not work with reclassified maps

r.random
 needs to be updated to GRASS 5

r.reclass
 - segm. fault on Pentium CPU (same problem as r.binfer,...)
 - does not accept "*" to reclass NULL values

r.surf.contour
  fixed by Pierre de Mouveaux <pmx@audiovu.com>
  (but supports currently CELL type only)

r.stats: some inconsistent results comparing to r.average
 *First, I compute the per-class averages:
     r.average base=medv cover=test out=borra.me
 *Second, I check the result for, i.e., class 23:
     d.what.rast map=medv,borra.me
     2676500(E) 4409500(N)
           medv in user1  (23)S_SUPRAMEDITERRANEAN_ZONE
           borra.me in user1, quant   (111)
           borra.me in user1, actual  (110.794075)
 *Third, I compute the statistics for each class, but the results are not
  the same as given by d.what.rast. For example, for class 23:
     r.stats -c in=medv,borra.me
     r.stats:  100%
       ...
       23 110.299171-110.744906 6082
       ...
 *While d.what.rast was giving 110.794075. Is this a bug?
     Dr. Agustin Lobo, alobo@ija.csic.es

s.in.ascii: 
     - errors with more than 2 dimensions (some numbers are read as
            attribute)

s.to.rast, s.to.vect:
 should accept sites_list even if #cats field is missing and
 only a %dbls field is there (like the output from r.to.sites)
 - > maybe fixed in s.to.rast?

s.rand
 should write #cats rather than %cats (site numbering)

v.reclass:
The problem with v.reclass seems to stem from an input field for old=new        
reclass rule that cannot be more than 7 characters long (i.e. 11250=16 is       
eight characters long and will cause v.reclass to return an error). Someone     
needs to look at correcting this perhaps.

v.surf.rst:
- outputs one elevation only. Bug seems to be introduced in GRASS 5 beta3

--------------------------------------------------

Platform specific stuff:

src/raster/r.combine:
make[2]: Entering directory /data3/grass5/src5/src/raster/r.combine/cmd'
rm -f gis_lxcl.c gis_pars.c gis_pars.h gis_pars.out
yacc -v -d gis_pars.y
1 rules never reduced
conflicts: 1 reduce/reduce
rm -f gis_pars.c gis_pars.h gis_pars.out


Further discussion:
-----------------------------------------------------------------------
Two severe problems (to be checked):

 - the mapdev/vector-modules need to be updated to new vector
   category support:
  Comment on vector cats from Bill Hughes:
  The Categories structure was changed between 4.x and 5.0beta.
  The change seems to have moved the *labels element out of the list
  structure and replace list.num with the index to **labels.  The fix
  is to change the SCS/* code to use 'cats->labels[i]' instead of
  'cats->list[i].labels'  There will be breakage around 'list[i].num'
  as well, and probably these can be deleted, or use 'cats->num' instead.
  The cats.count is cats.ncats now (see src/include/gis.h).

  Already sucessfully updated: v.random,v.extract,v.merge,v.autocorr
  updated src.contrib tree as well (10/99, Bill H.)

- src/libes/gis/set_windows.c
  There is a bug breaking a number of raster modules.
  This bug affects several commands including r.in.poly,r.digit,r.flow,
  r.bilinear, v.to.rast, ...

Jaro Hofierka on this:
  The bug is in ~src/libes/gis/set_window.c between lines 97-119.
  My quick fix was to remove these lines and re-compile gis lib and also
  all affected commands. Of course, it would be better to fix it in a more
  convenient way, however I have no time to figure out what is wrong there...
  
 ==> In GRASS 5 beta4h/4i this passage became commented as recommended by Jaro.
     The denoted modules are currently *working*! Will these comments cause
     any problems??


--------------------------------------------------------------------
src/libes/geom: optri  -> used by s.geom, v.geom
 I [Bill Hughes] have been working through some errors in 
src/libes/geom/optri and I have a tarball of the directory attached below.  
This is not done yet, but it needs some expertise from somebody who 
understands it.  Two references to grAllocate() have only 3 parameters.  
I don't understand what it does, so I can't really guess at what
should be passed as the final parameter.  I have put in 0 for the
moment to get the compile to work.

src/libes/geom/:
[from Brook] The powerof2 warnings are the result of an unfortunate 
collision of names (with different semantics) between NetBSD headers 
and Grass.  As long as the Grass headers are always included _after_ the 
system headers it is ok; it would be safer to rename it to something 
else within Grass, though.
 -> same warning on Linux/Intel

---------------------------------------------------------------------

 $Log: BUGS,v $
 Revision 1.16  2000-09-09 11:55:18  markus
 fixed r.los, r.info

 Revision 1.15  2000/09/08 21:53:37  markus
 cosmetics

 Revision 1.14  2000/09/08 21:52:16  markus
 cosmetics

 Revision 1.13  2000/08/26 13:00:51  markus
 more wishes and bug reports...

 Revision 1.12  2000/08/21 17:34:08  bernhard
 clarified r3.showdspf.openGL Mesa problem.

 Revision 1.11  2000/08/21 17:14:54  bernhard
 Added item to be checked: r3.showdspf.openGL dependency

 Revision 1.10  2000/08/20 15:44:40  markus
 g.manual bug fixed, r.mapcalc bug fixed on FreeBSD and Linux

 Revision 1.9  2000/07/28 08:27:25  markus
 g.version bug fixed, new reports on r.mapcalc and g.manual

 Revision 1.8  2000/07/26 13:10:44  markus
 r.support bug fixed by Huidae Cho

 Revision 1.7  2000/07/26 12:48:56  markus
 added r.in.tiff seg.fault

 Revision 1.6  2000/07/26 12:35:52  markus
 added i.ortho.photo bug comment

 Revision 1.5  2000/07/26 09:38:21  markus
 added d.mon -L comment

 Revision 1.4  2000/07/25 11:43:58  markus
 added v.surf.rst bug

 Revision 1.3  2000/07/12 14:56:33  markus
 added CELL driver color bug

 Revision 1.2  2000/07/12 13:29:51  markus
 added d.rgb

 Revision 1.1  2000/07/12 12:48:26  markus
 was documents/known_bugs_current.txt

 Revision 1.16  2000/07/10 13:52:37  markus
 added r.support bug

 Revision 1.15  2000/05/27 08:41:25  markus
 added cats.ncats info

 Revision 1.14  2000/05/15 18:13:38  markus
 added i.ortho.photo NULL bug

 Revision 1.13  2000/05/11 17:57:26  markus
 added p.map.new bug (is it still there?)

 Revision 1.12  2000/05/09 13:37:26  markus
 added d.legend and g.version bug

 Revision 1.11  2000/05/04 13:45:45  markus
  fixed r.timestamp bug and v.extract bug

 Revision 1.10  2000/04/17 19:35:13  markus
 added i.rectify and i.rectify2 fix (Pierre de Mouveaux <pmx@audiovu.com>), i.tape.tm.fast fixed (Markus Neteler)

 Revision 1.9  2000/04/17 13:51:37  markus
 r.surf.contour fixed by Pierre de Mouveaux <pmx@audiovu.com>

 Revision 1.8  2000/04/16 11:28:32  markus
 v.extract does not copy the category support for vector file

 Revision 1.7  2000/04/16 11:16:01  markus
 r.drain: fixed by Pierre de Mouveaux <pmx@audiovu.com>

 Revision 1.6  2000/04/12 13:48:19  markus
 added v.reclass bug

 Revision 1.5  2000/04/11 20:39:38  markus
 added further r.surf.contour bug

 Revision 1.4  2000/04/11 20:36:45  markus
 r.cost bug /segment lib bug fixed by Pierre de Mouveaux <pmx@audiovu.com>

 Revision 1.3  2000/04/06 17:55:25  markus
 added i.tape.tm.fast bugs

 Revision 1.2  2000/04/06 16:51:39  markus
 r.in.png/r.out.png removed, as they are written by Alex Shevlakov

 Revision 1.1  2000/04/05 08:25:15  markus
 was stored in docs/ before

 Revision 1.12  2000/02/22 17:33:12  markus
 i.shape fixed, removed here

 Revision 1.11  2000/02/16 12:02:41  markus
 added r.contour bug

 Revision 1.10  2000/02/15 17:57:10  markus
 added r.los seg.fault

 Revision 1.9  2000/02/09 16:28:12  markus
 added i.shape segfault

 Revision 1.8  2000/02/09 16:15:56  markus
 d.param.scale bug added, r.binfer bug specified

 Revision 1.7  2000/02/07 17:39:21  markus
 d.his color bug/NULL bug added

 Revision 1.6  2000/02/07 17:17:41  markus
 d.rast.num color bug added

 Revision 1.5  2000/02/04 11:19:42  markus
 added r.reclass bug on '*' and r.null wish

 Revision 1.4  2000/02/02 20:05:17  markus
 configure script improved, entry removed here

 Revision 1.3  2000/02/01 19:09:31  markus
 added r.reclass bug on Pentium CPU

 Revision 1.2  2000/02/01 18:47:42  markus
 d.legend/d.rast.leg bugs fixed (Markus)

 Revision 1.1  2000/02/01 17:47:04  markus
 was former known_bugs_jan2000.txt, added d.mon -L bug

 Revision 1.0e  2000/01/19 09:50:45  markus
 r.coin fixed. Added  r.binfer, r.cost, r.random

 Revision 1.0d  2000/01/18 12:45:52  markus
 added r.coin FP-bug

 Revision 1.0c  2000/01/12 14:58:04  markus
 d.area fixed. bug description for d.legend and d.rast.leg added

 Revision 1.0b  2000/01/12 11:47:32  markus
 added entries: r.info, r.in.tiff/r.out.tiff, r.in.png/r.out.png, r.timestamp, s.rand

 Revision 1.0a  2000/01/11 09:52:35  markus
 added i.rectify/2 problem

 Revision 1.0  2000/01/10 19:14:53  markus
