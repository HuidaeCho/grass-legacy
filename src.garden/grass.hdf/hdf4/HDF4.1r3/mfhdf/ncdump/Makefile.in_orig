# Makefile for ncdump(1).
#
# $Id$

PROGRAM		= ncdump
BINFILES	= $(PROGRAM)
HDF_LIB         = @HDF_LIB@
JPEG_LIB        = @JPEG_LIB@
HDF_INC         = @HDF_INC@
CPP_NETCDF	= -I../libsrc -I../port $(HDF_INC)
CPPFLAGS	= $(CPP_NETCDF) @CPPFLAGS@
CFLAGS		= @CFLAGS@
FFLAGS		= @FFLAGS@
MANIFEST	= Makefile.in ncdump.c ncdump.h  depend msoft.mk \
		  test0.cdl vardata.c vardata.h dumplib.c dumplib.h ncdump.1 \
                  make.com msofttab.c
MANUALS		= ncdump.1
LIBNAME		= netcdf
LD_NETCDF	= ../libsrc/libnetcdf.a
OBJS		=  ncdump.o vardata.o dumplib.o
LD_XDR		= @LD_XDR@
LD_NETCDF	= -L../libsrc -lnetcdf
LIBS		= $(LD_NETCDF) $(LD_XDR) $(HDF_LIB) $(JPEG_LIB) -lm
prefix		= ../../..
GARBAGE		= $(PROGRAM) test0.nc test1.nc test1.cdl test2.cdl

all::		$(PROGRAM)


test:		$(PROGRAM) test0.cdl
	$(NCGEN) -o test0.nc -n test0.cdl
	./$(PROGRAM) test0.nc > test1.cdl
	$(NCGEN) -o test1.nc -n test1.cdl
	./$(PROGRAM) -n test0 test1.nc > test2.cdl
	@cmp test1.cdl test2.cdl && \
	    echo "*** $(PROGRAM) test successful ***" ; \
	    rm test1.cdl test1.nc test2.cdl

install::	installed_program installed_manuals

include ../port/master.mk

# Override the default definition for ncgen(1) in the master makefile.
#
NCGEN		= ../ncgen/ncgen

### Everything after the following line might be overwritten ###
### DO NOT DELETE THIS LINE.  make depend DEPENDS ON IT ###
include depend
