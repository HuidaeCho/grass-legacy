LIBTRANS	= $(GIS)/src/mapdev/libes/libtrans.a
LIBDIGIT	= $(GIS)/src/mapdev/digit/libdigit.a
LIBDIG		= $(GIS)/src/mapdev/lib/libdig.a
LIBATTS		= $(LIBDIR)/libdig_atts.a
LIBGEO		= $(GIS)/src/mapdev/georef/libgeo.a

DIG_DRIVER		= $(ETC)/dig_drivers
#  specific driver we are compiling
DRIVER_DIR	= $(DIG_DRIVER)/calcomp
DRIVER_NAME	= CALCOMP


COMPILE_DIGIT 	= $(LDFLAGS) -o  digit  $(OBJ) $(LIBDIGIT)  $(LIBDIG) $(LIBTRANS) $(LIBATTS) $(DISPLAYLIB) $(RASTERLIB) $(VASKLIB) $(CURSES) $(MATHLIB) $(GISLIB)

EXTRA_CFLAGS	= -I$(GIS)/src/mapdev/digit -I$(GIS)/src/mapdev/libes

OBJ = \
	coll_pts.o \
	dig_curses.o \
	dig_dev.o \
	interface.o \
	setup_driver.o

GEO_REG = \
	dig_dev.o \
	geo_reg.o \
	interface.o \
	setup_driver.o

GEO_POINT = \
	dig_dev.o \
	geo_point.o \
	interface.o \
	setup_driver.o

all:  driver  geo.reg  geo.point

driver: $(DRIVER_DIR)  mk_driver_dig

$(DRIVER_DIR):
	-mkdir $@
#  make sure libdigit.a is there
	$(GIS)/src/CMD/Gmake  $(SRC)/mapdev/digit

mk_driver_dig: $(OBJ)
#  compile driver into the program
	$(CC) $(COMPILE_DIGIT)
	rm -f $(DRIVER_DIR)/digit
	mv digit $(DRIVER_DIR)/digit

#  'digit'  must be owned by root and have mode 06775
#  chown  root digit
#  chmod   06775 digit


#    geo.reg goes to etc/dig_drivers/? and is called by geo.reg in etc

geo.reg: $(GEO_REG)
	$(CC) $(LDFLAGS) -o  geo.reg  $(GEO_REG)  $(LIBGEO) $(LIBTRANS)  $(LIBDIG) $(VASKLIB) $(CURSES) $(MATHLIB) $(GISLIB)
	rm -f $(DRIVER_DIR)/geo.reg
	mv geo.reg $(DRIVER_DIR)/geo.reg

#    geo.point goes to etc/dig_drivers/? and is called by geo.point in etc

geo.point: $(GEO_POINT)
#  compile driver into the program
	$(CC) $(LDFLAGS) -o  geo.point  $(GEO_POINT)  $(LIBGEO) $(LIBTRANS) $(CURSES) $(MATHLIB) $(GISLIB)  $(LOCKLIB)
	rm -f $(DRIVER_DIR)/geo.point
	mv geo.point $(DRIVER_DIR)/geo.point


coll_pts.o: $(GIS)/src/mapdev/libes  $(GIS)/src/mapdev/digit/digit.h  $(GIS)/src/mapdev/digit/globals.h 
coll_pts.o: $(GIS)/src/mapdev/libes  $(GIS)/src/mapdev/digit/digit.h  $(GIS)/src/mapdev/digit/globals.h 
dig_curses.o:  dig_menu.h
dig_curses.o:  $(GIS)/src/mapdev/digit/digit.h
dig_curses.o:  $(GIS)/src/mapdev/digit/menu.h
dig_curses.o:  $(GIS)/src/mapdev/digit/curses.c
dig_curses.o:  $(GIS)/src/mapdev/libes/head.h

