:
# Bourne (Korn) shell script for installation of MAPGEN/PLOTGEN
# software distributed in this directory subsystem.
# This a hell or high-water procedure where we attempt to do as
# much as possible with error returns dumped in install.mon

# troff font descriptor library
font=/usr/lib/font/devGRAPH

# ensure shell to be executed by 'make' will be Bourne
SHELL=/bin/sh

# set GRAPH to current path
GRAPH=`pwd`
export GRAPH
MON=${GRAPH}/install.mon

# set monitor file
echo "GRAPH Installation on" `date` >$MON

# check RANLIB set
if [ ${RANLIB:-x} = "x" ] ; then
	echo "RANLIB not set!" | tee /dev/tty >>$MON
	echo "set environment parameter RANLIB to either echo or ranlib"
	exit 1
fi

# install plotter
cd graphics/plotter
make install
if [ $? -eq 0 ];then E="OK";else E="ERROR";fi
echo `pwd` "INSTALL:" $E >>$MON
if [ -f /usr/lib/libsunwindow.a ] ; then
# Install sundump for Sun 3/4 systems
	make -f Makesun install
	if [ $? -eq 0 ];then E="OK";else E="ERROR";fi
	echo `pwd` "Sun Modules:" "INSTALL:" $E >>$MON
else
	echo "non-Sun system" | tee /dev/tty >>$MON
fi
cd $GRAPH

# install tests
cd graphics/tests
make install
if [ $? -eq 0 ];then E="OK";else E="ERROR";fi
echo `pwd` "INSTALL:" $E >>$MON
cd $GRAPH

# Install troff fonts
if [ -d $font ] ; then
	echo "test" >${font}/test
	if [ $? = 0 ] ; then
		rm ${font}/test
# Install troff fonts
		cd graphics/fonts/troff
		make install
		if [ $? -eq 0 ];then E="OK";else E="ERROR";fi
		echo `pwd` "INSTALL:" $E >>$MON
		cd $GRAPH
	else
		echo "can't write to troff directory $font" | \
			tee /dev/tty >>$MON
	fi
else
	echo "troff directory $font doen't exist" | \
		tee /dev/tty >>$MON
fi

# install plotter fonts
cd graphics/fonts
Makefonts ${GRAPH}/lib/gfonts
if [ $? -eq 0 ];then E="OK";else E="ERROR";fi
echo `pwd` "INSTALL:" $E >>$MON
cd $GRAPH

# Install basic MAPGEN/PLOTGEN support library
cd lib/Libgen
make install
if [ $? -eq 0 ];then E="OK";else E="ERROR";fi
echo `pwd` "INSTALL:" $E >>$MON
cd $GRAPH

# Install PLOTGEN sub-system
cd plotgen
make install
if [ $? -eq 0 ];then E="OK";else E="ERROR";fi
echo `pwd` "INSTALL:" $E >>$MON
if [ -f /usr/lib/libsunwindow.a ] ; then
# Install szoom for Sun 3/4 systems
	make -f Makesun install
	if [ $? -eq 0 ];then E="OK";else E="ERROR";fi
	echo `pwd` "Sun Modules:" "INSTALL:" $E >>$MON
else
	echo "non-Sun system" | tee /dev/tty >>$MON
fi
cd $GRAPH

# Install MAPGEN sub-system

# Install proj
cd proj
make install
if [ $? -eq 0 ];then E="OK";else E="ERROR";fi
echo `pwd` "INSTALL:" $E >>$MON
cd $GRAPH

# Install mapgen programs
cd mapgen
make install
if [ $? -eq 0 ];then E="OK";else E="ERROR";fi
echo `pwd` "INSTALL:" $E >>$MON
cd $GRAPH

# install coastline procedures
cd mapgen/coast
make install
if [ $? -eq 0 ];then E="OK";else E="ERROR";fi
echo `pwd` "INSTALL:" $E >>$MON
cd $GRAPH

# Install bivariate support program
cd mapgen/bivar
make install
if [ $? -eq 0 ];then E="OK";else E="ERROR";fi
echo `pwd` "INSTALL:" $E >>$MON
cd $GRAPH

# Install definition program: mapdef
cd mapgen/mapdef
make install
if [ $? -eq 0 ];then E="OK";else E="ERROR";fi
echo `pwd` "INSTALL:" $E >>$MON
cd $GRAPH

echo "
export GRAPHB
GRAPHB=${GRAPH}/bin/plotter:${GRAPH}/lib/gfonts/:sr:
PATH=${GRAPH}/bin:${PATH}" >sh_locenv

echo "
setenv GRAPHB ${GRAPH}/bin/plotter:${GRAPH}/lib/gfonts/:sr:
setenv PATH ${GRAPH}/bin:${PATH}" >csh_locenv

echo "MAPGEN/PLOTGEN install complete on" `date` | tee /dev/tty >>$MON

exit 0
