.\" @(#)bivar.1 - 1.1
.nr LL 5.5i
.TH BIVAR 1 2/20/89 "USGS/OEMG Systems"
.ad b
.hy 1
.SH NAME
bivar - determine bivariate polynomial coefficients
.SH SYNOPSIS
.LP
.B bivar
[ -cefmorstvw [args]]
[ file ]
.SH DESCRIPTION
.I Bivar
determines a set of bivariate polynomial coefficients which
will approximate the bivariate data contained in
.I file.
The bivariate polynomial is expressed as:

	f(x,y) = Cmn * Pm(x) * Qn(y) [m=0,M, [n=0,n]]

where the univariate degree M may be user specified.
Univariate polynomials P and Q can be either monomials or
Chebyshev.
The coefficients are determined from the input x, y and z data
(optionally with weighting terms) by standard least squares
methods.
The range of the x and y data is reduced to the interval of
+1 and -1 to assist in the determination.

Output consists of the error level of the determination,
number of coefficients determined.
The second two lines contain the scaling, offset and minumum
and maximum values of the respective x and y axis.
Finally, the last sequence of data consists of the number of
coefficients of the set of coefficients evaluating
with minimal error, the absolute value of the maximum error and
the ordered coefficient values.

The following options can appear in any order:
.TP
.BI \-c
If this option is selected then the Chebyshev polynomial
is employed.
Otherwise the default selection is a simple monomial series.
.TP
.BI \-e " epsilon"
.I Epsilon
is a floating point value which determines relative tolerance
test for loss of significance.
Reasonable values are between 1e-10 and 1e-15; default: 1e-15.
.TP
.BI \-t " eta"
.I eta
is a floating point value which determines relative tolerance
for square sum of errors.
Reasonable values are between 1 and 1e-15; default: 1e-15.
.TP
.BI \-r " factor"
.I Factor
is a floating point value which expands the computed range of the
dependent variables by the specified relative value.
Default: 0..
.TP
.BI \-m " degree"
.I Degree
is an integral value which determines the maximum polynomial
degree in either axis.
.TP
.BI \-s " size"
.I Size
is an integral value which specifies the maximum number of
data values to be input in determination of the series.
Default value: 200.
.TP
.BI \-o " file"
.I File
is the name of an optional output file for results.
If not specified,
.I sysout
is implied.
.TP
.BI \-f " format"
Format is and ascii string of C "scanf" format form to allow
handling of specialized data not in the form of 3 (or 4)
floating point values per line.
.TP
.BI \-w
If
.I \-w
is specified then a weight value is associated with each input
data item.
.TP
.BI \-x
If
.I \-x
is specified then the relative position of the
.I x
and
.I y
values on each input data line are reversed.
.TP
.BI \-v
When specified
.I bivar
becomes verbose in its operation.
.TP
.BI file
Each line of the specified
.I file
contains a set of real values: x, y, z and optionally a weight
value.
If the data are not deformatable with a simple sequence
of "%le" format specifications the
.I \-f
option must be employed.
If a
.I file
is not specified
.I stdin
is assumed.
.SH EXAMPLE
The following determines the third degree coefficients of for Chebyshev
polynomials for the data in file
.I data.in :
   bivar -cm 3 data.in
.SH FILES
 None.
.SH SEE ALSO
 Scientific Subroutine Package, ver III, IBM, 1970
.SH DIAGNOSTICS
 Various monitoring is provided.
.SH BUGS
Too early to tell (probably).
.SH AUTHOR/MAINTENANCE
Gerald I. Evenden, USGS, Woods Hole, MA.
