C$NOFLOATCALLS
	SUBROUTINE EPLOT(KP,KS,KL,KB,XMIN,YMIN,XMAX,YMAX,MORF)
	INTEGER*2 IOUT(4)
	CHARACTER*1 ANS,T(38),STAR,BL,T1(69),Z(80)
	CHARACTER*10 MORF
	DATA STAR,BL/'*',' '/
5	OPEN(8,FILE='TEMP',STATUS='NEW')
10	FORMAT(1h ,'PLOT',76X)
	DO 20 I=1,4
20	IOUT(I)=0
	IF(KP.EQ.0) GO TO 55
30	WRITE(0,40)
40	FORMAT(/' USE PUDDLE GRID OUTPUT? ')
	READ(5,50)ANS
50	FORMAT(A1)
	IF(ANS.NE.'N'.AND.ANS.NE.'Y')  GO TO 30
	IF(ANS.EQ.'Y')  IOUT(1)=1
55	IF(KL.EQ.0) GO TO  75
60	WRITE(0,70)
70	FORMAT(/' USE LOCATOR OUTPUT? ')
	READ(5,50)ANS
	IF(ANS.NE.'N'.AND.ANS.NE.'Y') GO TO 60
	IF(ANS.EQ.'Y') IOUT(2)=1
75	IF(KS.EQ.0) GO TO 95
80	WRITE(0,90)
90	FORMAT(/' USE SCATTER OUTPUT? ')
	READ(5,50)ANS
	IF(ANS.NE.'N'.AND.ANS.NE.'Y') GO TO 80
	IF(ANS.EQ.'Y') IOUT(3)=1
95	IF(KB.EQ.0) GO TO 115
100	WRITE(0,110)
110	FORMAT(/' USE BASE OUTPUT? ')
	READ(5,50)ANS
	IF(ANS.NE.'N'.AND.ANS.NE.'Y') GO TO  100
	IF(ANS.EQ.'Y') IOUT(4)=1
115	CONTINUE
120	FORMAT(1h ,4I1,76X)
130	WRITE(0,140)
140	FORMAT(/' SCALE [50000]: ')
	READ(5,*,ERR=130)SC
150	WRITE(0,160)
160	FORMAT(/' %X [1.0]: ')
	READ(5,*,ERR=150)PX
170	WRITE(0,180)
180	FORMAT(/' %Y [1.0]: ')
	READ(5,*,ERR=170)PY
190	WRITE(0,200)
200	FORMAT(/' MAGNIFICATION [1.0]: ')
	READ(5,*,ERR=190)XM
210	WRITE(0,220)
220	FORMAT(/' % SMOOTHING [0.333]: ')
	READ(5,*,ERR=210)PS
230	WRITE(0,240)
240	FORMAT(/' FIRST CONTOUR LEVEL TO BE PLOTTED [65]: ')
	READ(5,*,ERR=230) IP
250	WRITE(0,260)
260	FORMAT(/' LAST CONTOUR LEVEL TO BE PLOTTED [75]: ')
	READ(5,*,ERR=250)LP
270	LINC=0
	IL=0
	LL=0
280	WRITE(0,290)
290	FORMAT(/' CONTOUR INCREMENT [10]: ')
	READ(5,*,ERR=280)INC
	L=-1
310	WRITE(0,320)
320	FORMAT(/' DO YOU WANT LABELS? ')
	READ(5,50)ANS
	IF(ANS.NE.'N'.AND.ANS.NE.'Y') GO TO 310
	IF(ANS.EQ.'Y') L=1
	IF(L.EQ.-1) GO  TO 365
325	WRITE(0,330)
330	FORMAT(/' FIRST CONTOUR TO BE LABELED [65]: ')
	READ(5,*,ERR=325)IL
335	WRITE(0,340)
340	FORMAT(/' LAST CONTOUR TO BE LABELED [75]: ')
	READ(5,*,ERR=335)LL
350	WRITE(0,360)
360	FORMAT(/' LABEL INCREMENT [10]: ')
	READ(5,*,ERR=350)LINC
365	CONTINUE
370	FORMAT(1h ,F7.0,4F4.2,4I3,3I2,4F9.1,3X)
380	WRITE(0,390)
390	FORMAT(/' ANY ADDITIONAL TEXT TO DISPLAY? ')
	READ(5,50)ANS
	IF(ANS.EQ.'N') GO TO 600
	IF(ANS.NE.'Y') GO TO 380
400	WRITE(0,410)'X'
410	FORMAT(/' STARTING LOCATION OF TEXT - ',A1,
     $	'-COORDINATE: ')
	READ(5,*,ERR=400)X
420	WRITE(0,410)'Y'
	READ(5,*,ERR=420)Y
430	WRITE(0,440)
440	FORMAT(/' HEIGHT OF TEXT: ')
	READ(5,*,ERR=430)HT
450	WRITE(0,460)
460	FORMAT(/' ANGLE OF TEXT [0 DEG]: ')
	READ(5,*,ERR=450)ANG
	IC=1
470	WRITE(0,480)
480	FORMAT(/' ARE COORDINATES PLOTTER COORDINATES? ')
	READ(5,50)ANS
	IF(ANS.NE.'N'.AND.ANS.NE.'Y') GO TO 470
	IF(ANS.EQ.'Y') IC=0
	WRITE(0,490)
490	FORMAT(/' TEXT (FIRST 38 CHARACTERS): ')
	READ(5,560)T
510	WRITE(0,520)
520	FORMAT(/' MORE TEXT FOR THIS LOCATION? ')
	READ(5,50)ANS
	IF(ANS.EQ.'Y') GO TO 540
	IF(ANS.NE.'N') GO TO 510
	WRITE(8,530)X,Y,HT,ANG,IC,T,STAR
530	FORMAT(1h ,2F10.0,2F10.2,I1,39A1)
	GO TO  580
540	WRITE(0,550)
550	FORMAT(/' TEXT (NEXT 69 CHARACTERS): ')
	READ(5,560)T1
560	FORMAT(69A1)
	WRITE(8,530)X,Y,HT,ANG,IC,T,BL
	WRITE(8,570)HT,T1,STAR
570	FORMAT(1h ,F10.2,70A1)
580	WRITE(0,590)
590	FORMAT(/' ANOTHER TEXT LOCATION? ')
	READ(5,50)ANS
	IF(ANS.EQ.'Y') GO TO 400
	IF(ANS.NE.'N') GO TO 580
600   WRITE(8,610)
	IF(SC.EQ.0.)SC=50000.
610   FORMAT(1H ,79X,'*')
	IF(PX.EQ.0.)PX=1.0
	IF(PY.EQ.0.)PY=1.0
	IF(XM.EQ.0.)XM=1.0
	XS=SC/PX/12.0
	YS=SC/PY/12.0
	IF(MORF.EQ.'METERS')  THEN
		XS=XS*0.0254*12.0
		YS=YS*0.0254*12.0
	ENDIF
	SX=(XMAX-XMIN)/XS*PX*XM+0.5
	SY=(YMAX-YMIN)/YS*PY*XM+0.5
	ISX=SX/10.2+1.0
	ISY=SY/7.5 +1.0
	DO 615  I=1,ISX
	DO 615  J=1,ISY
	WRITE(7,10)
	WRITE(7,120)IOUT
	II=I-1
	JJ=J-1
	WRITE(7,370)SC,PX,PY,XM,PS,IP,LP,IL,LL,L,INC,LINC,
     $	II*10.2,I*10.2,JJ*7.5,J*7.5
 	REWIND 8
	READ(8,612,END=615)Z
612	FORMAT(80A1)
613	FORMAT(1h ,80A1)
	WRITE(7,613)Z
615	CONTINUE
C	CLOSE(8)
620	WRITE(0,630)
630	FORMAT(/' MORE PLOTS? ')
	READ(5,50)ANS
	IF(ANS.EQ.'Y') GO  TO 5
	IF(ANS.NE.'N') GO TO 620
	RETURN
	END
