	SUBROUTINE MODULE
	CHARACTER*1 ANS,RES
	CHARACTER*13 FILE
	CHARACTER*80 A
	CHARACTER*10 MORF,MODL
	CHARACTER*70 B
	OPEN(7,FILE='BNOISEIN.DAT',STATUS='NEW')
	WRITE(0,10)
10	FORMAT(/' ENTER MODULE DATA')
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
C     	FILE INPUT
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
15	WRITE(0,20)
20	FORMAT(/' DO YOU WANT TO INPUT FROM A FILE? ')
	READ(5,30)ANS
30	FORMAT(A1)
	IF(ANS.EQ.'N') GO TO 430
	IF(ANS.NE.'Y') GO TO 15
	WRITE(0,40)
40	FORMAT(/' FILE NAME: ')
	READ(5,50) FILE
50	FORMAT(A13)
	OPEN(13,FILE=FILE,IOSTAT=I)
	REWIND 13
	IF(I.EQ.0) GO TO 90
	WRITE(0,60)
60	FORMAT(' FILE ERROR')
	GO TO 15
80	FORMAT(A80)
81	FORMAT(1h ,A80)
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
C	CORRECTIONS
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
90	WRITE(0,100)
100	FORMAT(/' ANY CHANGES? ')
	READ(5,30)ANS
	IF(ANS.EQ.'N') GO TO 420
	IF(ANS.NE.'Y') GO TO 90
105	WRITE(0,110)
110	FORMAT(/' METERS OR FEET? ')
	READ(5,120)MORF
120	FORMAT(A10,A70)
121	FORMAT(1h ,A10,A70)
	IF(MORF.NE.'METERS'.AND.MORF.NE.'FEET') GO TO 105
	WRITE(7,121)MORF
	READ(13,120)MORF
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
C	MAP CARDS
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
130	WRITE(0,140)
140	FORMAT(/' CHANGE MAP MODULE DATA? ')
	READ(5,30)ANS
	IF(ANS.NE.'N'.AND.ANS.NE.'Y')  GO TO 130
	I=0
150	READ(13,120)MODL,B
	I=I+1
	IF(I.NE.3)  GO TO 155
	BACKSPACE 13
	READ(13,152)DAYS
152	FORMAT(F10.0,70X)
153	FORMAT(1h ,F10.0,70X)
155	CONTINUE
	IF(MODL.EQ.'BOUNDS') GO TO 160
	IF(ANS.EQ.'N') WRITE(7,121)MODL,B
	GO TO  150
160	BACKSPACE 13
	IF(ANS.EQ.'Y') CALL EMAP(DAYS)
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
C	BOUNDS CARDS
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
170	WRITE(0,175)
175	FORMAT(/' CHANGE BOUNDS MODULE DATA? ')
	READ(5,30)ANS
	IF(ANS.NE.'N'.AND.ANS.NE.'Y') GO TO 170
	READ(13,80)A
	IF(ANS.EQ.'N')WRITE(7,81)A
	READ(13,180)XMIN,YMIN
180	FORMAT(2F10.0,60X)
181	FORMAT(1H ,2F10.0,60X)
	IF(ANS.EQ.'N') WRITE(7,181)XMIN,YMIN
	READ(13,180)XMAX,YMAX
	IF(ANS.EQ.'N') WRITE(7,181)XMAX,YMAX
	IF(ANS.EQ.'Y') CALL EBOUND(XMIN,YMIN,XMAX,YMAX)
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
C	BASE CARDS (OPTIONAL)
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
190	WRITE(0,195)
	KB=0
195	FORMAT(/' CHANGE BASE MODULE DATA? ')
	READ(5,30)ANS
	IF(ANS.NE.'N'.AND.ANS.NE.'Y') GO TO 190
	READ(13,120)MODL,B
	BACKSPACE 13
	IF(MODL.NE.'BASE') GO TO 215
	RES='N'
	IF(ANS.EQ.'Y')  GO TO 200
197	WRITE(0,264)'BASE'
	READ(5,30)RES
	IF(RES.EQ.'N') GO TO 200
	IF(RES.NE.'Y') GO TO 197
200	READ(13,120)MODL,B
	IF(MODL.EQ.'FORM-A') GO TO 210
	IF(ANS.EQ.'N'.AND.RES.EQ.'N') WRITE(7,121)MODL,B
	GO TO 200
210	BACKSPACE 13
	IF(RES.EQ.'N') KB=1
215	IF(ANS.EQ.'Y')  CALL EBASE(XMIN,YMIN,XMAX,YMAX)
	IF(ANS.EQ.'Y')  KB=1
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
C	FORM-A CARDS
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
220	WRITE(0,230)
230	FORMAT(/' CHANGE FORM-A MODULE DATA? ')
	READ(5,30)ANS
	IF(ANS.NE.'N'.AND.ANS.NE.'Y') GO TO 220
	DO 240 I=1,3
	READ(13,80)A
	IF(ANS.EQ.'N'.AND.I.EQ.3)WRITE(7,153)DAYS
	IF(ANS.EQ.'N'.AND.I.NE.3) WRITE(7,81)A
240	CONTINUE
	IF(ANS.EQ.'Y') CALL EFORM(DAYS)
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
C	PUDDLE GRID CARDS (OPTIONAL)
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
250	WRITE(0,260)
	KP=0
260	FORMAT(/' CHANGE PUDDLE GRID MODULE DATA? ')
	READ(5,30) ANS
	IF(ANS.NE.'N'.AND.ANS.NE.'Y') GO  TO  250
	READ(13,120)MODL,B
	BACKSPACE 13
	IF(MODL.NE.'PUDDLE GRI') GO TO 275
	RES='N'
	IF(ANS.EQ.'Y')  GO TO  268
262	WRITE(0,264)'PUDDLE GRID'
264	FORMAT(/' DELETE EXISTING ',A,' MODULE DATA? ')
	READ(5,30)RES
	IF(RES.EQ.'N') GO TO 268
	IF(RES.NE.'Y')  GO TO 262
268	DO 270 I=1,2
	READ(13,80)A
	IF(ANS.EQ.'N'.AND.RES.EQ.'N') WRITE(7,81)A
270	CONTINUE
	IF(RES.EQ.'N') KP=1
275	IF(ANS.EQ.'Y') CALL EPGRID
	IF(ANS.EQ.'Y') KP=1
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
C	POINT CARDS (OPTIONAL)
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
280	WRITE(0,290)
290	FORMAT(/' CHANGE POINT MODULE DATA? ')
	READ(5,30)ANS
	IF(ANS.NE.'N'.AND.ANS.NE.'Y') GO TO 280
	READ(13,120)MODL,B
	BACKSPACE 13
	IF(MODL.NE.'POINT') GO TO 315
	RES='N'
	IF(ANS.EQ.'Y')  GO TO 300
292	WRITE(0,264)'POINT'
	READ(5,30)RES
	IF(RES.EQ.'N') GO TO  300
	IF(RES.NE.'Y') GO TO 292
300	READ(13,120)MODL,B
	IF(MODL.EQ.'SCATTER'.OR.MODL.EQ.'LOCATOR'.OR.MODL.EQ.'PLOT'
     $	.OR.MODL.EQ.'STOP') GO TO 310
	IF(ANS.EQ.'N'.AND.RES.EQ.'N') WRITE(7,121)MODL,B
	GO TO 300
310	BACKSPACE 13
315	IF(ANS.EQ.'Y') CALL EPOINT
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
C	SCATTER CARDS (OPTIONAL)
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
320	WRITE(0,330)
	KS=0
330	FORMAT(/' CHANGE SCATTER MODULE DATA? ')
	READ(5,30)ANS
	IF(ANS.NE.'N'.AND.ANS.NE.'Y') GO TO 320
	READ(13,120)MODL,B
	BACKSPACE 13
	IF(MODL.NE.'SCATTER') GO TO 345
	RES='N'
	IF(ANS.EQ.'Y') GO TO 338
332	WRITE(0,264)'SCATTER'
	READ(5,30)RES
	IF(RES.EQ.'N') GO TO 338
	IF(RES.NE.'Y') GO TO 332
338	DO 340 I=1,3
	READ(13,80)A
	IF(ANS.EQ.'N'.AND.RES.EQ.'N'.AND.I.EQ.3)WRITE(7,153)DAYS
	IF(ANS.EQ.'N'.AND.RES.EQ.'N'.AND.I.NE.3)WRITE(7,81)A
340	CONTINUE
	IF(RES.EQ.'N') KS=1
345	IF(ANS.EQ.'Y') CALL ESCAT(DAYS)
	IF(ANS.EQ.'Y') KS=1
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
C	LOCATOR CARDS (OPTIONAL)
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
350	WRITE(0,360)
	KL=0
360	FORMAT(/' CHANGE LOCATOR MODULE DATA? ')
	READ(5,30)ANS
	IF(ANS.NE.'N'.AND.ANS.NE.'Y') GO TO 350
	READ(13,120)MODL,B
	BACKSPACE 13
	IF(MODL.NE.'LOCATOR') GO TO 375
	RES='N'
	IF(ANS.EQ.'Y') GO TO 368
362	WRITE(0,264)'LOCATOR'
	READ(5,30)RES
	IF(RES.EQ.'N') GO TO 368
	IF(RES.NE.'Y') GO TO 362
368	DO 370 I=1,2
	READ(13,80)A
	IF(ANS.EQ.'N'.AND.RES.EQ.'N') WRITE(7,81)A
370	CONTINUE
	IF(RES.EQ.'N') KL=1
375	IF(ANS.EQ.'Y') CALL ELOC
	IF(ANS.EQ.'Y') KL=1
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
C	PLOT CARDS (OPTIONAL)
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
380	WRITE(0,390)
390	FORMAT(/' CHANGE PLOT MODULE DATA? ')
	READ(5,30)ANS
	IF(ANS.NE.'N'.AND.ANS.NE.'Y') GO TO 380
	READ(13,120)MODL,B
	BACKSPACE 13
	IF(MODL.NE.'PLOT') GO TO 410
	RES='N'
	IF(ANS.EQ.'Y') GO TO 400
392	WRITE(0,264)'PLOT'
	READ(5,30)RES
	IF(RES.EQ.'N') GO TO  400
	IF(RES.NE.'Y') GO TO 392
400	READ(13,120)MODL,B
	IF(MODL.EQ.'STOP')  GO TO 410
	IF(ANS.EQ.'N'.AND.RES.EQ.'N') WRITE(7,121)MODL,B
	GO TO 400
410	IF(ANS.EQ.'Y') CALL EPLOT(KP,KS,KL,KB,XMIN,YMIN,XMAX,YMAX,MORF)
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
C	STOP CARD
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
	WRITE(7,460)
	GO TO 425
420	READ(13,80,END=425)A
	WRITE(7,81)A
	GO TO 420
425	CLOSE(13)
	GO TO 500
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
C	ALL NEW DATA
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
430	WRITE(0,110)
	KP=0
	KS=0
	KL=0
	KB=0
	READ(5,120)MORF
	IF(MORF.NE.'METERS'.AND.MORF.NE.'FEET')GO TO 430
	WRITE(7,121)MORF
	WRITE(0,435)'MAP'
435	FORMAT(/' ENTER ',A,' MODULE DATA')
	CALL EMAP(DAYS)
	WRITE(0,435)'BOUNDS'
	CALL EBOUND(XMIN,YMIN,XMAX,YMAX)
436	WRITE(0,450)'BASE'
	READ(5,30)ANS
	IF(ANS.NE.'N'.AND.ANS.NE.'Y') GO TO 436
	IF(ANS.EQ.'Y') CALL EBASE(XMIN,YMIN,XMAX,YMAX)
	IF(ANS.EQ.'Y')  KB=1
	WRITE(0,435)'FORMA'
	CALL EFORM(DAYS)
437	WRITE(0,450)'PUDDLE GRID'
	READ(5,30)ANS
	IF(ANS.NE.'N'.AND.ANS.NE.'Y') GO TO 437
	IF(ANS.EQ.'Y') CALL EPGRID
	IF(ANS.EQ.'Y') KP=1
440	WRITE(0,450) 'POINT'
450	FORMAT(/' ANY ',A,' MODULE DATA?  ')
	READ(5,30)ANS
	IF(ANS.NE.'N'.AND.ANS.NE.'Y') GO TO 440
	IF(ANS.EQ.'Y') CALL EPOINT
452	WRITE(0,450)'SCATTER'
	READ(5,30)ANS
	IF(ANS.NE.'N'.AND.ANS.NE.'Y') GO TO 452
	IF(ANS.EQ.'Y') CALL ESCAT(DAYS)
	IF(ANS.EQ.'Y') KS=1
454	WRITE(0,450)'LOCATOR'
	READ(5,30)ANS
	IF(ANS.NE.'N'.AND.ANS.NE.'Y') GO TO 454
	IF(ANS.EQ.'Y')CALL ELOC
	IF(ANS.EQ.'Y') KL=1
456	WRITE(0,450)'PLOT'
	READ(5,30)ANS
	IF(ANS.NE.'N'.AND.ANS.NE.'Y') GO TO 456
	IF(ANS.EQ.'Y') CALL EPLOT(KP,KS,KL,KB,XMIN,YMIN,XMAX,YMAX)
	WRITE(7,460)
460	FORMAT(1H ,'STOP',76X)
500	CONTINUE
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
C	SAVE MODULE CARDS
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
510	WRITE(0,520)
520	FORMAT(/' SAVE MODULE DATA ON FILE? ')
	READ(5,30)ANS
	IF(ANS.EQ.'N') GO TO 600
	IF(ANS.NE.'Y') GO TO 510
	WRITE(0,40)
	READ(5,50)FILE
	OPEN(9,FILE=FILE,STATUS='NEW')
      REWIND 7
530	READ(7,80,END=540)A
	WRITE(9,81)A
	GO TO530
540	CLOSE(9)
600	CONTINUE
	CLOSE(7)
	RETURN
	END
