It seems that the centroid calculation is nonsense.
Update this!
