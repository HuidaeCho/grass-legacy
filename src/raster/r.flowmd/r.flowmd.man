.SH NAME
\fIr.flowmd\fR \- construction of slope lines (flowlines), 
flowpath lengths and flowline  densities from  a
raster digital elevation model using a modified multiple directions 
algorithm.

.br
\fI(GRASS Raster/Vector Program)\fR
.SH SYNOPSIS
.B r.flowmd
.br
\fBr.flowmd help\fR
.br
\fBr.flowmd\fR [\fB-d\fR] \fBelevin=name\fR \fBaspin=name\fR \fBbarrierin=name\fR [\fBskip=val\fR] [\fBflout=name\fR [\fBlgout=name\fR] [\fBdsout=name\fR]

.SH DESCRIPTION
\fIr.flowmd\fR

.br
generates flowlines using a combined raster-vector
approach from input elevation \fIelevin\fR, aspect \fIaspin\fR
and optionally barrier \fIbarrierin\fR raster maps. 
.LP
Input elevation raster map with integer values should have values 
in centimeters preventing premature flowline stop in flat areas. 
Aspect used for input
must follow the same rules as aspect computed in other GRASS
programs (see r.slope.aspect, s.surf.tps).
Barriers are defined by non-zero values in an input raster
map \fIbarierin\fR.
Make sure that the resolution of your current region
is set to the resolution of the elevation raster file.
.LP
There are three possible output maps which can be produced in
any combination simultaneously:  a vector file \fIflout\fR of flowlines,
a raster map \fIlgout\fR of flowpath lengths, and a raster map 
\fIdsout\fR of flowline densities.
Flowlines are constructed by straight line segments (vectors) with endpoints
creating intersections of the flowline with edges of the imaginary
mesh connecting centers of the grid cells.  Flowlines are generated from each 
cell uphill by default; they can
be generated downhill using the flag \fB-d\fR. 
A flowline stops if its next segment would reverse the direction of flow
(from up to down or vice-versa),
cross a barrier, or arrive at a cell with undefined elevation or aspect.
Another option, \fBskip\fR=\fIval\fR, indicates that only the flowlines from
every \fIval\fRth cell are to be included in \fIflout\fR.  The default
\fBskip\fR is 1.
A high \fBskip\fR usually speeds up processing time and often improves
the readability of a visualization of \fIflout\fR.

.LP
Flowpath length output \fIflout\fR gives the horizontal length of the flowline for given grid cell in units defined by your mapset. It is computed as the sum of the planar length of
all straight flowline segments.  
.LP
Flowline density output \fIdsout\fR represents the number of generated flowlines
passing through the given cell. This program uses a modified multiple directions
algorithm. Flowline density for each flowline passing between 2 grid cell centers is  
fractioned between these grid cells by distance. This algorithm smoothes 
flowline densities on convex (dispersing) slopes.
Flowline lengths and densities can be computed for both uphill and downhill
directionss.

.SH OPTIONS
The user can run this program either interactively or non-interactively.
The program will be run non-interactively if the user specifies
program arguments and flag settings on the command line using the form:
.LP
.RS
\fBr.flowmd\fR [\fB-d\fR] \fBelevin=name\fR \fBaspin=name\fR [\fBbarrierin=name\fB] [\fBskip=val\fR] [\fBflout=name\fR] [\fBlgout=name\fR] [\fBdsout=name\fR]

.RE
.LP
Alternately, the user can simply type \fBr.flowmd\fR on the command line
without program arguments.  In this case, the user will be prompted for
parameter values and flag settings using the standard GRASS parser interface.

.LP 
\fBFlag:\fR 
.IP [\fB-d\fR] 18 
Generate flowlines downhill (default generates flowlines uphill)

.LP
\fBParameters:\fR
.IP \fBelevin\=\fIname\fR 18
Use the existing raster file with elevations\fIname\fR as input.
.IP \fBaspin\=\fIname\fR 18
Use the existing raster file with aspect\fIname\fR as input.
.IP \fBbarrierin\=\fIname\fR 18
Use the existing raster file with non-zero values representing
barriers with \fIname\fR as input.
.IP \fBskip\=\fIval\fR 18
Set the the number of cells skipped for origins of flowlines to \fIval\fR.
.IP \fBflout\=\fIname\fR 18
Output coordinates of flowlines to vector file named  \fIname\fR.
.IP \fBlgout\=\fIname\fR 18
Output flowpath length values to raster file named  \fIname\fR.
.IP \fBdsout\=\fIname\fR 18
Output flowline density values to raster file named  \fIname\fR.

.SH NOTES

Flowlines generated uphill are used for computation of the flowpath
length (slope lenghts) defining the distance between the grid cell  
and upland area. 
This can be used, for example, in
water erosion modeling for the computation of LS factor
in standard form of USLE.
Flowlines can be also generated downhill from each grid point to simulate
the topographic potential for quasi steady-state overland water flow.
Downslope flowline
density multiplied by grid cell area gives the upslope contributing 
area.  This topographic parameter  defines an area from which water 
inflows to the given cell.
This area is an estimate of potential steady-state water flux and can be used
in the modeling of water erosion and for computation of unit stream
power based LS factor.
The program has been designed for modeling erosion on hillslopes and
has a very strict condition for ending the flowline. It is therefore not very
suitable for the extraction of stream network or delineation of watersheds
unless a DEM without pits or flat areas is available.

.TE
.LP
.SH "SEE ALSO"
.I "r.flow, r.watershed, r.drain, r.slope.aspect, s.surf.tps"

.LP
.SH "AUTHOR"
Jaroslav Hofierka, GeoModel s.r.o., Bratislava, Slovakia

.LP
.SH "REFERENCES"
Mitasova, H. and Hofierka, J. (1993): Interpolation by Regularized Spline with
Tension: II. Aplication to Terrain Modeling and Surface Geometry Analysis.
Mathemtical Geology August, 1993
.br
Mitasova, H., Hofierka, J., Zlocha, M., Iverson, L.(1993): Modeling
topographic potential for erosion and deposition using GIS.
submitted to IJofGIS.
.br
Mitasova, H.(1993): Surfaces and modeling. Grassclippings (winter
and spring ) p.18-19.
