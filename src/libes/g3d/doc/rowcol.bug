From brown@gomez.gis.uiuc.edu Tue Jun  3 15:59:23 1997
Received: from gis.uiuc.edu (root@stumpy.gis.uiuc.edu [128.174.248.29]) by gomez.gis.uiuc.edu (8.8.5/8.7.3) with SMTP id PAA15407; Tue, 3 Jun 1997 15:59:21 -0500 (CDT)
Received: from woden.gis.uiuc.edu by gis.uiuc.edu (SMI-8.6/SMI-SVR4)
	id PAA28152; Tue, 3 Jun 1997 15:43:42 -0500
From: brown@gis.uiuc.edu
Received: by woden.gis.uiuc.edu (931110.SGI) id AA28681; Tue, 3 Jun 97 15:40:16 -0500
Date: Tue, 3 Jun 97 15:40:16 -0500
Message-Id: <9706032040.AA28681@woden.gis.uiuc.edu>
To: waupo@sal.cs.uiuc.edu
Subject: rows & cols
Status: RO


Hi Roman,

I don't want to bother you, but if you have any hints about what
could be the problem, I'd appreciate it -

I think the G3d library is reversing rows & columns in the
read or write routines (hard to tell which) because r3.in.ascii
then r3.out.ascii results in data that doesn't match (although
the headers match).  So when I started to look at the G3d code, 
it seems that rows & cols are exactly opposite what GRASS uses, eg:

G3d - type rows & cols:

    for (z = 0; z < depths; z++) {
      for (y = 0; y < cols; y++) {
	  for (x = 0; x < rows; x++) {

GRASS - type rows & cols:

    for (z = 0; z < depths; z++) {
      for (y = 0; y < rows; y++) {    /* northing */
	  for (x = 0; x < cols; x++) {  /* easting */

So I wondered if you remember doing this on purpose, or only for
tiling or what.  Any hints?

Thanks,

Bill



From brown@gomez.gis.uiuc.edu Tue Jun  3 17:28:15 1997
Received: from gis.uiuc.edu (root@stumpy.gis.uiuc.edu [128.174.248.29]) by gomez.gis.uiuc.edu (8.8.5/8.7.3) with SMTP id RAA15680; Tue, 3 Jun 1997 17:28:13 -0500 (CDT)
Received: from woden.gis.uiuc.edu by gis.uiuc.edu (SMI-8.6/SMI-SVR4)
	id RAA28223; Tue, 3 Jun 1997 17:12:38 -0500
From: brown@gis.uiuc.edu
Received: by woden.gis.uiuc.edu (931110.SGI) id AA29369; Tue, 3 Jun 97 17:09:12 -0500
Date: Tue, 3 Jun 97 17:09:12 -0500
Message-Id: <9706032209.AA29369@woden.gis.uiuc.edu>
To: Roman Waupotitsch <waupo@geomagic.com>
Subject: Re: rows & cols
References: <9706032040.AA28681@woden.gis.uiuc.edu>
Status: RO

I switched both r3.in.ascii and r3.out.ascii to use grass-type 
rows and cols, but I made them both consistant. I didn't think
it should make a difference as long as they both were changed, but
apparently it does because when I changed them back to opposite
rows & cols, the data comes out the same.  Hmmm, confusing.  The
reason I changed it to match GRASS was so that we could use
r.out.ascii to cat together several layers, then r3.in.ascii
to generate a new volume.  

The more I look at this the more confused I get - I'll have to 
take another look tomorrow.  I still think there is a problem
somewhere - maybe just terminology with x & y -

> can you send the entire input and output data set. the fragment you sent
> to me looks too scary to me (as if the data in the third row is random.)

No, it was just the first 20 values of the second row. (each row is 60)
Don't worry about it - I'll try to figure out more tomorrow.

Thanks - 

Bill


From brown@gomez.gis.uiuc.edu Wed Jun  4 11:00:07 1997
Received: from gis.uiuc.edu (root@stumpy.gis.uiuc.edu [128.174.248.29]) by gomez.gis.uiuc.edu (8.8.5/8.7.3) with SMTP id LAA20489; Wed, 4 Jun 1997 11:00:05 -0500 (CDT)
Received: from woden.gis.uiuc.edu by gis.uiuc.edu (SMI-8.6/SMI-SVR4)
	id KAA28601; Wed, 4 Jun 1997 10:44:28 -0500
From: brown@gis.uiuc.edu
Received: by woden.gis.uiuc.edu (931110.SGI) id AA01628; Wed, 4 Jun 97 10:41:01 -0500
Date: Wed, 4 Jun 97 10:41:01 -0500
Message-Id: <9706041541.AA01628@woden.gis.uiuc.edu>
To: Roman Waupotitsch <waupo@geomagic.com>
Subject: Re: rows & cols
References: <9706032040.AA28681@woden.gis.uiuc.edu>
    <9706032136.AA29012@woden.gis.uiuc.edu>
Status: RO


OK, I think I see what's going on now.  It seems that G3d
considers x to be the north-south dimension, y the east-west
dimension, but GRASS and all of our programs think
west->east is changing x.  So I guess I can get around it by swapping
the x & y, nx & ny values in all of our calls to G3d
functions and when using volume data, treat it as column-major
(N-S direction changes fastest). We didn't notice this 
before because we were looking at volume data by itself,
not trying to fit it to geographic data.  Also, Mark used
a sphere for some of the testing, which wouldn't tell us if
the rows & cols were being swapped.  Maybe I'll write a couple
more library functions to get row-major volume data so that
our isosurface routines don't need to be rewritten.

Does this sound right to you?

Thanks,

bill



From waupo@geomagic.com Wed Jun  4 11:22:07 1997
Received: from gis.uiuc.edu (root@stumpy.gis.uiuc.edu [128.174.248.29]) by gomez.gis.uiuc.edu (8.8.5/8.7.3) with SMTP id LAA20538 for <brown@gomez>; Wed, 4 Jun 1997 11:22:06 -0500 (CDT)
Received: from mailhost.geomagic.com by gis.uiuc.edu (SMI-8.6/SMI-SVR4)
	id LAA29012; Wed, 4 Jun 1997 11:06:27 -0500
Received: from luti.geomagic.com (luti.geomagic.com [206.139.88.107]) by mailhost.geomagic.com (8.7.5/8.7.3) with SMTP id LAA20868 for <brown@gis.uiuc.edu>; Wed, 4 Jun 1997 11:06:09 -0500 (CDT)
Sender: waupo@geomagic.com
Message-ID: <33959270.167E@geomagic.com>
Date: Wed, 04 Jun 1997 11:06:08 -0500
From: Roman Waupotitsch <waupo@geomagic.com>
Organization: Raindrop Geomagic, Inc.
X-Mailer: Mozilla 3.01 (X11; I; IRIX 6.3 IP32)
MIME-Version: 1.0
To: brown@gis.uiuc.edu
Subject: Re: rows & cols
References: <9706032040.AA28681@woden.gis.uiuc.edu>
	    <9706032136.AA29012@woden.gis.uiuc.edu> <9706041541.AA01628@woden.gis.uiuc.edu>
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
Status: RO

i think the problem comes from the fact that i never used "real" data
while developing g3d code. so i did not catch this problem. i am still
surprised though about the phenomenon you mentioned yesterday (i.e
changing x and y in both r3.in.ascii and r3.out.ascii). if you could
open the contribution directory for me i could take a quick look into
the code and see how north/south and row/col relate to each other.

sorry about the problems,
roman

From waupo@geomagic.com Wed Jun  4 14:53:19 1997
Received: from gis.uiuc.edu (root@stumpy.gis.uiuc.edu [128.174.248.29]) by gomez.gis.uiuc.edu (8.8.5/8.7.3) with SMTP id OAA21027 for <brown@gomez>; Wed, 4 Jun 1997 14:53:18 -0500 (CDT)
Received: from mailhost.geomagic.com by gis.uiuc.edu (SMI-8.6/SMI-SVR4)
	id OAA29349; Wed, 4 Jun 1997 14:37:41 -0500
Received: from luti.geomagic.com (luti.geomagic.com [206.139.88.107]) by mailhost.geomagic.com (8.7.5/8.7.3) with SMTP id OAA21270 for <brown@gis.uiuc.edu>; Wed, 4 Jun 1997 14:37:22 -0500 (CDT)
Sender: waupo@geomagic.com
Message-ID: <3395C3F2.446B@geomagic.com>
Date: Wed, 04 Jun 1997 14:37:22 -0500
From: Roman Waupotitsch <waupo@geomagic.com>
Organization: Raindrop Geomagic, Inc.
X-Mailer: Mozilla 3.01 (X11; I; IRIX 6.3 IP32)
MIME-Version: 1.0
To: brown@gis.uiuc.edu
Subject: Re: rows & cols
References: <9706032040.AA28681@woden.gis.uiuc.edu>
	    <9706032136.AA29012@woden.gis.uiuc.edu>
	    <9706041541.AA01628@woden.gis.uiuc.edu> <9706041636.AA01917@woden.gis.uiuc.edu>
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
Status: RO

ok,

i looked through all the files which use north/south and row/col. they
seem to be consistent, but switched. another unfortunate thing is that
i used the order "ew_res, ns_res, tb_res" for the parameters of the
internal functions. but at least they are also used consistently. 

i don't dare to make the changes without actually testing the code, but
it seems to me that switching rows and colums can be done by changing
code in approximately 8 files. all the internal code works with x,y,z
so there is no danger of an averlange effect.

roman

