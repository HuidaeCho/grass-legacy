# note INFORMIXDIR is obtained from the Unix env. If make
# doesn't support this, then it will have to be added to
# the CMD/head file.


DBMIDIR = $(GISBASE)/driver/db

EXTRA_CFLAGS = -I$(INFORMIXDIR)/incl/esql

.SUFFIXES: .ec
.ec.c:
	rm -f $@; esql -e $?

# STUBLIB = ../libstubs.a

LIBES = $(DBMILIB) $(STUBLIB)
DEPLIBS = $(DEPDBMILIB) $(STUBLIB)

OBJ = main.o	\
	close_cur.o	\
	column.o	\
	connect.o	\
	cursor.o	\
	database.o	\
	delete.o	\
	descriptor.o	\
	describe.o	\
	engine.o	\
	execute.o	\
	fetch.o		\
	finddb.o	\
	insert.o	\
	listdb.o	\
	listtab.o	\
	index.o		\
	open_ins.o	\
	open_sel.o	\
	open_upd.o	\
	path.o		\
	sql_eof.o	\
	sql_error.o	\
	table.o		\
	tbname.o	\
	update.o

$(DBMIDIR)/informix: $(DBMIDIR) $(OBJ) $(DEPLIBS)
	esql $(LDFLAGS) -o $@ $(OBJ) $(LIBES) $(XDRLIB)

$(DBMIDIR):
	-mkdir -p $(DBMIDIR)

$(OBJ): $(INCLUDE_DIR)/dbmi.h globals.h

$(DEPLIBS): #
