  {
    int dims=0, cat=0, strs=0, dbls=0;
    
    if (G_site_describe(fdinp, &dims, &cat, &strs, &dbls) != 0) {
      sprintf(buf, "failed to guess format");
      clean_fatal_error(buf);
    }

    /* Fix for case where no category given */
    if (cat == -1)
      cat=FCELL_TYPE;

    /* Read site header */
    G_site_get_head(fdinp,&site_info);

    /* Allocate space for site structure */
    site_mgt = G_site_new_struct (cat, dims, strs, dbls);
  }

  while (G_site_get(fdinp, site_mgt) != -1) {
    if (which_att > site_mgt->dbl_alloc) {
      char err_msg[200];
      sprintf(err_msg, "Error: Specified attribute %d but site file has only %d\n",
	      which_att, site_mgt->dbl_alloc);
      G_fatal_error(err_msg);
    }

    /* Decrement which_att to make array references correct */
/*    which_att--; this was bug, fixed by puting w=site_mgt->dbl_att[which_att-1]; */
    x=site_mgt->east;
    y=site_mgt->north;

    /* Check to make sure there is a Z dimension for this site file,
       if not then signal an error and exit.
     */
    if (site_mgt->dim_alloc == 0) {
      clean_fatal_error("Error: input site file must contain a Z coordinate");
    }
    z=site_mgt->dim[0];
    w=site_mgt->dbl_att[which_att-1];

