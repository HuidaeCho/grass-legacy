<!doctype html public "-//w3c//dtd html 4.0 transitional//en">
<html>
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=koi8-r">
   <meta name="GENERATOR" content="Mozilla/4.77 [ru] (X11; U; Linux 2.2.19-3.asp i686) [Netscape]">
   <meta name="Author" content="Alex Shevlakov, sixote@yahoo.com">
   <title>GRASS code i18n mini-HOWTO</title>
</head>
<body text="#000000" bgcolor="#FFFFFF" link="#0000EF" vlink="#59188E" alink="#FF0000">
<b><font size=+1>GRASS code internationalization&nbsp;
(i18n) mini-HOWTO.</font></b>
<br><b><font size=-1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
by Alex Shevlakov <i>sixote@yahoo.com</i></font></b>
<br>&nbsp;
<blockquote><a href="#p1">1. GRASS modules code and Gmakefile changes.</a>
<br><a href="#p2">2. GRASS libraries code and Gmakefile changes.</a>
<br><a href="#p3">3. Using gettext binaries for messages catalogues creation
and maintenance.</a></blockquote>

<p><br><a NAME="p1"></a><b>1. GRASS modules code and Gmakefile changes.</b>
<p>To prepare a module being able to translate its messages to the user's
locale national language, the module's developer or maintainer has to make
the following changes into the code and Gmakefile of this module:
<br>&nbsp;
<blockquote>a) Lines of C code which contain translatable strings, e.g.,
<br><i>&nbsp; fprintf(stderr, "This module is cool!\n");</i>
<br>have to be replaced with
<br><i>&nbsp; fprintf(stderr, _("This module is cool!\n"));</i>
<br>i.e., all "comments" are put inside brackets and underscored from the
left, thus becoming _("comments"). No changes into any other lines are
needed.
<p>b) Files with C code that have been modified in this way must be referenced
to the header file "glocale.h". Add line <i>#include "glocale.h" </i>somewhere
below other 'include' directives.</blockquote>

<blockquote>c) The Gmakefile of this module has to be modified to have
the following additional compiler options definitions in it:
<p>PACKAGE = "<i>your_module_name</i>"
<br>DEFS = -DPACKAGE=\"$(PACKAGE)\"
<br>EXTRA_CFLAGS&nbsp;&nbsp;&nbsp; = $(...) $(...) ... $(DEFS)</blockquote>

<p><br><a NAME="p2"></a><b>2. GRASS libraries code and Gmakefile changes.</b>
<p>Statements a), b) and c) from the first paragraph wholly apply to the
procedure of GRASS libraries code i18n changes.&nbsp; The 'PACKAGE' variable
would be called, for libraries, 'libgis' or 'libraster', etc.
<p><a NAME="p3"></a><b>3. Using gettext binaries for messages catalogues
creation and maintenance.</b>
<br>&nbsp;
<p>In the C files catalogue of a module or library, run command:
<p>&nbsp;&nbsp; xgettext -a *.c -o <i>your_module_name</i>.po
<p>This creates a new template .po file which you (module NLS maintainer)
have to edit. See other manuals and HOWTO's that explicitly cover the .po
files editing, including header part with names of the translation team
members. Usually, it is just enough to take any existing .po file as ready
example.
<p>After your .po file is ready, test that the module and libs translate
new messages: run
<p>&nbsp;&nbsp; msgfmt <i>your_module_name</i>.po -o <i>your_module_name</i>.mo
<p>and put the result .mo file in the GRASS locale catalogue ($GISBASE/locale/your_language/LC_MESSAGES).
Then run the module and see if the translations are done correctly.
<p>From time to time, as the code gets changed by developers, run
<p>&nbsp;&nbsp; msgmerge old.po new.po > <i>your_module_name</i>.po
<p>where old.po is the outdated version of the module and new.po is done
by 'xgettext -a *.c'. This updates translatable line numbers.
</body>
</html>
